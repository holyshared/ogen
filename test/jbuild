(library (
  (name ogen_all)
  (libraries (ogen.cli ogen.file_system ogen.jbuilder ogen.project))
  (library_flags -linkall)
  (preprocess (pps (ppx_jane ppx_driver.runner)))
))

(executable (
  (name test_runner)
  (libraries (ppx_inline_test.runner.lib ogen_all))
))

(alias
  ((name runtest)
  (deps (test_runner.exe))
  (action (run ${<} inline-test-runner ogen_filesystem -diff-cmd "diff -u --label actual --label expected"))))

(alias
  ((name runtest)
  (deps (test_runner.exe))
  (action (run ${<} inline-test-runner ogen_jbuilder -diff-cmd "diff -u --label actual --label expected"))))

(jbuild_version 1)
